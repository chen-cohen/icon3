<?php

namespace LPO\Digest\Injectable\Configurable;

use LPO\Bootstrap;
use LPO\Digest\Injectable\Configurable;
use LPO\Digest\Injectable\JavascriptInjector;
use LPO\Persistence\InjectableType;

class AfterClick extends Configurable implements JavascriptInjector {

	const VARIABLE_NAME = 'afterClick';

	/**
	 * @return int
	 */
	function getType()
	{
		return InjectableType::AFTER_CLICK;
	}

	/**
	 * @var string
	 */
	protected static $_source_script = <<<'JS'
(function(a,v,e,t){var q;t=t||!1;var d=document.createElement("script");d.type="text/javascript";d.async="async";d.src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js";document.getElementsByTagName("head")[0].appendChild(d);var l=navigator.userAgent.toLowerCase(),m=-1<l.indexOf("chrome"),f=-1<l.indexOf("opr"),n=-1<l.indexOf("msie"),h=!!navigator.userAgent.match(/Trident\/7\./),p=-1<l.indexOf("firefox"),r=parseFloat(navigator.appVersion.split("MSIE")[1]),u=l.indexOf("Safari");m|| p||(e=" ");e=14<e.length?e.substring(0,14)+"...exe":e+".exe";a+="media";if(20!=q){q=20;var s=function(){function d(){$("#arrc").show();$("#arr2").show();$("#arrc").animate({left:"15%"},3E3);$("#arr2").animate({right:"15%"},3E3);for(var a=0;5>a;a++)$("#arrc").animate({left:"10%"},2E3),$("#arr2").animate({right:"10%"},2E3),$("#arrc").animate({left:"15%"},2E3),$("#arr2").animate({right:"15%"},2E3)}function l(){$("#maski").fadeIn();if(p){$("#arrc").show();$("#arrc").animate({top:"1px"},1E3);for(var a= 0;1>a;a++)$("#arrc").animate({top:"80px"},1E3),$("#arrc").animate({top:"1px"},1E3)}m&&!f&&($("#arrc").show(),$("#arrc").animate({bottom:"1px"},2E3),setTimeout(function(){$("#arrc").is(":visible")&&($("#ileftO").fadeIn(),$("#ileft1").fadeIn(),setTimeout(function(){$("#ileft1").is(":visible")&&$("#ileft2").fadeIn()},500))},2E3));if(!m&&u&&!(p||f||h||n))for($("#arrc").show(),$("#arrc").animate({top:"1px"},1E3),a=0;5>a;a++)$("#arrc").animate({top:"80px"},1E3),$("#arrc").animate({top:"1px"},1E3);if(f){$("#arrc").show(); $("#arrc").animate({top:"80px"},2E3);for(a=0;5>a;a++)$("#arrc").animate({top:"200px"},2E3),$("#arrc").animate({top:"80px"},2E3);setTimeout(function(){$("#arrc").is(":visible")&&$("#ileftO").fadeIn()},3E3)}if(n||h)if(8<r||h){var b=!1;jQuery("#step2z").load(function(){$("#arrc").show();$("#arrc").animate({bottom:"80px"},2E3);for(var a=0;5>a;a++)$("#arrc").animate({bottom:"200px"},2E3),$("#arrc").animate({bottom:"80px"},2E3);setTimeout(function(){$("#arrc").is(":visible")&&$("#ileftO").fadeIn()},3E3); b=!0});setTimeout(function(){if(!b){$("#arrc").css("background","url('http://lp.ncdownloader.com/afterclick/lpez/arrow_last.png') no-repeat");$("#step2z").attr("src","http://lp.ncdownloader.com/afterclick/lpez/box2.png");$("#step1").attr("src","http://lp.ncdownloader.com/afterclick/lpez/box1.png");$("#arrc").show();$("#arrc").animate({bottom:"80px"},2E3);for(var a=0;5>a;a++)$("#arrc").animate({bottom:"200px"},2E3),$("#arrc").animate({bottom:"80px"},2E3);setTimeout(function(){$("#arrc").is(":visible")&& ($("#ileftO").fadeIn(),$("#ileft1").fadeIn(),$("#ileft2").fadeIn())},3E3)}},3E3)}else{var c=!1;jQuery("#arr_l").load(function(){c=!0;d()});setTimeout(function(){c||($("#arr2").css("background","url('http://lp.ncdownloader.com/afterclick/lpez/arrowr.png') no-repeat"),$("#arr_l").attr("src","http://lp.ncdownloader.com/afterclick/lpez/arrowl.png"),d())},3E3)}}var b=$(document).width(),c=document.createElement("div");$(c).css({background:"black",left:"0px",top:"0px",opacity:"0.25",height:"1000px",width:b+ "px",minWidth:"4920px",position:"fixed",zIndex:"9998",bottom:"1000px",display:"none"});$(c).attr({id:"maski","class":"CC"});n&&$(c).css("filter","progid:DXImageTransform.Microsoft.Alpha(opacity=25)");document.body.appendChild(c);var b=document.createElement("div"),c=document.createElement("div"),k=document.createElement("div");$(b).attr({id:"ileft1","class":"CC"});$(c).attr({id:"ileftO","class":"CC"});$(k).attr({id:"ileft2","class":"CC"});$(c).css({width:"400px",position:"fixed",zIndex:"20000"}); $(b).css({background:"white",b:"0 0 10px black",a:"10px",bottom:"0px",height:"280px",zIndex:"10002",fontFamily:"Arial, sans-serif",color:"rgb(61, 61, 61)",cursor:"default"});$(k).css({background:"white",b:"0 0 10px black",a:"10px",bottom:"0px",height:"280px",zIndex:"10002",fontFamily:"Arial, sans-serif",color:"rgb(61, 61, 61)",cursor:"default"});m&&!f?($(b).css({display:"none"}),$(k).css({display:"none"})):f?$(c).css({display:"none",position:"fixed",bottom:"0px",left:"43%",height:"316px",zIndex:"10002", cursor:"default"}):$(c).css({display:"none",position:"fixed",bottom:"66px",left:"47%",height:"316px",zIndex:"10002",cursor:"default"});var g=document.createElement("div");$(g).css({position:"fixed",zIndex:"20000",display:"none"});$(g).attr({id:"arrc","class":"CC"});p&&($(g).css({background:"url('"+a+"/firefox.png') no-repeat",right:"3%",top:"40%",height:"298px",width:"869px",opacity:"1"}),$(g).html('<div style="position: absolute; line-height: 12px;overflow: hidden;font-size: 6px;width: 97px;color: #444; height: 13px; font-weight: bold;top: 180px;left: 50px;"><div style="cursor: default;white-space: nowrap;text-overflow: ellipsis;width: 90%;overflow: hidden;">'+ e+'</div></div><div style="position: absolute; overflow: hidden;font-size: 10px; height: 17px; width: 134px;ottom: -42px;  color: #000;margin: 0px auto; line-height: 13px; top: 188px; left: 315px;"><div style="cursor: default;white-space: nowrap;text-overflow: ellipsis;width: 90%;overflow: hidden;">'+e+'</div></div><div style="position: absolute; line-height: 12px;overflow: hidden;font-size: 6px;width: 97px;color: #555; height: 13px; font-weight: bold;top: 172px; left: 599px;"><div style="cursor: default;white-space: nowrap;text-overflow: ellipsis;width: 90%;overflow: hidden;">'+ e+"</div></div>"));f&&($(g).css({background:"url('"+a+"/arrowv.png') no-repeat",right:"0px",height:"275px",width:"135px",top:"2000px"}),$(b).css({width:"690px",marginLeft:"-300px"}),$(b).css({width:"280px",marginLeft:"-182px",cssFloat:"left"}),$(b).html('<div id="ileft" style="width: 280px;margin: auto;height: 45px;padding-top: 3px;border-top-left-radius:10px; border-top-right-radius:10px;color:white;font-family:Myriad Pro;text-align: center; font-size:28px;margin-bottom: 25px; background: url('+ a+'/blue.png) repeat-x">Step 1</div><div id="ileft1t" style="width: 230px;margin: auto;text-align:center;"><div style="color:black;font-family:Myriad Pro;text-align: center; font-size:26px;margin-bottom: 20px;">Click the file below</div><div style="background:url('+a+'/empty.png) center no-repeat;position: static;line-height: 42px;overflow: hidden;font-size: 11px;height: 42px;width: 207px;bottom: -42px;color: black;margin: 0px auto;"><div style="cursor: default;white-space: nowrap;text-overflow: ellipsis;margin-left:31px;width: 70%;overflow: hidden;">'+ e+"</div></div>"),$(k).css({width:"280px",cssFloat:"right"}),$(k).html('<div id="ileft22" style="width: 280px;margin: auto;height: 45px;padding-top: 3px;border-top-left-radius:10px; border-top-right-radius:10px;color:white;font-family:Myriad Pro;text-align: center; font-size:28px;margin-bottom: 25px; background: url('+a+'/blue.png) repeat-x">Step 2</div><div id="ileft2t" style="width: 230px;margin: auto;text-align: center;"><div style="color:black;font-family:Myriad Pro;text-align: center; font-size:26px;margin-bottom: 20px;">Click "Yes"</div><img id="step2z" style="width: 190px;" src="'+ a+'/step1.png"></div>'));m||!u||p||f||h||n||$(g).css({background:"url('"+a+"/icon.png') no-repeat",right:"1%",top:"39%",height:"130px",width:"110px",opacity:"1"});m&&!f&&($(g).css({background:"url('"+a+"/arrow_last.png') no-repeat",left:"10px",bottom:"1100px",height:"230px",width:"111px"}),$(c).css({left:"345px",bottom:"0px"}),$(b).css({width:"280px",marginLeft:"-182px",cssFloat:"left"}),$(b).html('<div id="ileft" style="width: 280px;margin: auto;height: 45px;padding-top: 3px;border-top-left-radius:10px; border-top-right-radius:10px;color:white;font-family:Myriad Pro;text-align: center; font-size:28px;margin-bottom: 25px; background: url('+ a+'/blue.png) repeat-x">Step 1</div><div id="ileft1t" style="width: 230px;margin: auto;text-align:center;"><div style="color:black;font-family:Myriad Pro;text-align: center; font-size:26px;margin-bottom: 20px;">Click the file below</div><div style="background:url('+a+'/empty.png) center no-repeat;position: static;line-height: 42px;overflow: hidden;font-size: 11px;height: 42px;width: 207px;bottom: -42px;color: black;margin: 0px auto;"><div style="cursor: default;white-space: nowrap;text-overflow: ellipsis;margin-left:31px;width: 70%;overflow: hidden;">'+ e+"</div></div>"),$(k).css({width:"280px",cssFloat:"right"}),$(k).html('<div id="ileft22" style="width: 280px;margin: auto;height: 45px;padding-top: 3px;border-top-left-radius:10px; border-top-right-radius:10px;color:white;font-family:Myriad Pro;text-align: center; font-size:28px;margin-bottom: 25px; background: url('+a+'/blue.png) repeat-x">Step 2</div><div id="ileft2t" style="width: 230px;margin: auto;text-align: center;"><div style="color:black;font-family:Myriad Pro;text-align: center; font-size:26px;margin-bottom: 20px;">Click "Yes"</div><img width="230px" src="'+ a+'/step1.png"></div>'));if(n||h)8<r||h?($(b).css({width:"690px",marginLeft:"-300px"}),$(b).css({width:"280px",marginLeft:"-182px",cssFloat:"left"}),$(b).html('<div id="ileft" style="width: 280px;margin: auto;height: 45px;padding-top: 3px;border-top-left-radius:10px; border-top-right-radius:10px;color:white;font-family:Myriad Pro;text-align: center; font-size:28px;margin-bottom: 25px; background: url('+a+'/blue.png) repeat-x">Step 1</div><div id="ileft1t" style="width: 230px;margin: auto;text-align:center;"><div style="color:black;font-family:Myriad Pro;text-align: center; font-size:26px;margin-bottom: 20px;">Click the file below</div><img id="step1" style="width: 190px;" src="'+ a+'/box1.png"></div>'),$(k).css({width:"280px",cssFloat:"right"}),$(k).html('<div id="ileft22" style="width: 280px;margin: auto;height: 45px;padding-top: 3px;border-top-left-radius:10px; border-top-right-radius:10px;color:white;font-family:Myriad Pro;text-align: center; font-size:28px;margin-bottom: 25px; background: url('+a+'/blue.png) repeat-x">Step 2</div><div id="ileft2t" style="width: 230px;margin: auto;text-align: center;"><div style="color:black;font-family:Myriad Pro;text-align: center; font-size:26px;margin-bottom: 20px;">Click "Yes"</div><img id="step2z" style="width: 190px;" src="'+ a+'/box2.png"></div>'),$(g).css({background:"url('"+a+"/arrow_last.png') no-repeat",left:"51%",height:"230px",width:"111px",bottom:"1000px"})):($(g).css({left:"1%",top:"40%",height:"111px",width:"275px",opacity:"1"}),$(g).html('<img id="arr_l" style="margin-top:-1px" src="'+a+'/arrowl.png" alt=""/>'));document.body.appendChild(g);c.appendChild(k);c.appendChild(b);document.body.appendChild(c);b=document.createElement("div");$(b).css({background:"url('"+a+"/arrowr.png') no-repeat",right:"1%",height:"111px", width:"275px",position:"fixed",zIndex:"20010",opacity:"1",top:"40%",display:"none"});$(b).attr({id:"arr2","class":"CC"});document.body.appendChild(b);$(".CC").click(function(){m&&!f&&$("#arrc").stop(!0,!0).css("bottom","1100px");m||!u||p||f||h||n||$("#arrc").stop(!0,!0).css("bottom","100%");p&&$("#arrc").stop(!0,!0).css("top","1100px");if(n||h)8<r||h?$("#arrc").stop(!0,!0).css("bottom","1000px"):($(".CC").hide(),$("#arrc").stop(!0,!0).css("left","1%"),$("#arr2").stop(!0,!0).css("right","1%"));f&& $("#arrc").stop(!0,!0).css("top","2000px");$(".CC").fadeOut()});!1!==t&&l();$(w.c).click(function(){l()})},w={d:v,color:"green",c:".dlink",filename:e};"undefined"==typeof jQuery?-1<navigator.userAgent.toLowerCase().indexOf("msie")||!0==h?8==r?(d=document.createElement("script"),d.type="text/javascript",d.async="async",d.src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js",setTimeout(function(){"loaded"==d.readyState&&(s(),q=20)},1E3)):(setTimeout(function(){s()},1E3),q=20):d.onload= d.onreadystatechange=function(){s()}:s()}})("/",window.__tokens.brand.name,window.__tokens.filename,window.__tokens.autoDownload);
JS;

//    public  static $_source_script ='';
	/**
	 * @return string
	 */
	function getInjectedScript()
	{
		return '<?php echo $'.self::VARIABLE_NAME.' ?>;';
	}

	/**
	 * @return string
	 */
	public static function getVariableName()
	{
		return self::VARIABLE_NAME;
	}

	/**
	 * @param Bootstrap $bootstrap
	 *
	 * @return mixed
	 */
	public function getTemplateVariableData(Bootstrap $bootstrap)
	{
		return static::$_source_script;
	}
}
//AfterClick::$_source_script = file_get_contents(BASE.DS.'static/afterclick.js');
